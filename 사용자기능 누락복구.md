---
title: "ADC 플랫폼 | 누락 메뉴 보완 구현 작업지시서 (Anti-Gravity) v1.0"
scope: "IA/라우트/페이지 스캐폴딩 + 최소 UI + API 연동 포인트 정의"
target: "현재 UI(개요/설계 실행/카탈로그) 기반, v1.3 체크리스트 갭 해소"
priority: "Phase 0~1 필수"
---

# 0) 목표(Definition of Done)

## DoD(완료 기준)
- 좌측 사이드바에 아래 신규 메뉴가 노출되고, 각 메뉴는 “빈 페이지”가 아닌 **최소 UI(테이블/필터/상태 배지/액션 버튼)** 를 가진다.
- 각 페이지는 API 연동 전이라도 **mock data 또는 placeholder state** 로 동작한다.
- 각 화면의 핵심 액션은 버튼까지 구현하고, 버튼은 **/api/** 엔드포인트(또는 예정 엔드포인트)로 연결될 준비가 되어 있어야 한다.
- 런 상세 → 후보 상세 → 비교 → 리포트 출력까지 **탐색 플로우가 끊기지 않는다.**

---

# 1) IA(메뉴) 최종 확정안

## 1.1 사이드바(권장)
- 개요 `/`
- 설계 실행
  - 런 목록 `/design/runs`
  - 런 상세 `/design/runs/[runId]`
  - 후보 비교 `/design/runs/[runId]/compare?ids=a,b`
  - 리포트 `/design/runs/[runId]/reports`
- 카탈로그
  - Targets `/catalog/targets`
  - Linkers `/catalog/linkers`
  - Payloads `/catalog/payloads`
  - Antibody Templates `/catalog/antibodies`
  - Protocol Templates `/catalog/protocol-templates`
  - Ruleset `/catalog/rulesets`
  - Scoring Params `/catalog/scoring-params`
  - 컴포넌트 상태 관리 `/catalog/status` (pending/active/failed)
- 데이터 & 근거(신규)
  - 데이터 업로드 `/data/upload`
  - 업로드 내역 `/data/uploads`
  - 심층 문헌 검색 `/evidence/search`
  - 문헌 수집/인덱싱 상태 `/evidence/ingestion`
  - 근거 품질/충돌(Conflict) `/evidence/quality`
- 운영/관리(신규)
  - 시스템 상태(워커/큐/DB) `/ops/status`
  - 작업 큐/실패 재시도 `/ops/queues`
  - 감사 로그(Audit) `/ops/audit`
  - 로그/에러(런타임) `/ops/logs`

> NOTE: 상단 네비(대시보드/설계 실행/카탈로그)는 유지하되, 신규 메뉴는 사이드바 확장을 기준으로 한다.

---

# 2) 신규 페이지별 최소 UI 요구사항(MVP)

## 2.1 데이터 업로드 `/data/upload`
### 목적
- 실험 결과(assay) 또는 외부 파일을 업로드하고, 업로드 히스토리로 추적 가능하게 한다.

### UI(최소)
- 업로드 카드
  - 파일 선택(Drag&Drop)
  - 업로드 타입 선택(Select): `assay_results`, `protocol_outputs`, `misc`
  - 메모(optional)
  - [업로드] 버튼
- 안내 박스
  - 허용 포맷: CSV/XLSX/JSON/PDF
  - 업로드 후 “파싱/검증”은 백그라운드로 처리됨(표시만)

### API 포인트(예정)
- `POST /api/data/uploads` (multipart)
- `GET /api/data/uploads?limit=20&offset=0`

---

## 2.2 업로드 내역 `/data/uploads`
### UI(최소)
- 테이블 컬럼:
  - `uploaded_at`, `type`, `filename`, `size`, `status`(queued/processing/done/failed), `run_id(optional)`, `actions`
- 액션:
  - [상세] [재시도] (failed 시) [연결된 run 보기]

---

## 2.3 심층 문헌 검색 `/evidence/search`
### 목적
- PubMed 등에서 evidence 검색 + 결과를 “근거로 연결 가능한 형태”로 보여준다.

### UI(최소)
- 검색 바 + 필터:
  - 키워드(필수)
  - 연도 범위, 타입(논문/리뷰/임상), polarity(positive/negative/neutral)
- 결과 리스트:
  - title, year, journal, key snippet(짧게), polarity badge, citations count(있으면)
- 액션:
  - [문서 보기] [청킹 보기] [이 문서를 인덱싱에 추가]

### API 포인트(예정)
- `GET /api/evidence/search?q=...&filters=...`
- `POST /api/evidence/index/add` (pmid/doi)

---

## 2.4 문헌 수집/인덱싱 상태 `/evidence/ingestion`
### 목적
- 커넥터(PubMed) 증분 수집 상태, 커서, 실패/재시도를 운영자가 확인.

### UI(최소)
- 커넥터 상태 카드:
  - last_run_at, cursor, docs_ingested, chunks_created, embeddings_done, failures
- 실행 버튼:
  - [지금 수집 실행] [재처리] [실패 항목 재시도]
- 테이블:
  - doc_id(pmid/doi), status(queued/processing/done/failed), updated_at, error

### API 포인트(예정)
- `GET /api/evidence/ingestion/status`
- `POST /api/evidence/ingestion/run`
- `POST /api/evidence/ingestion/retry?doc_id=...`

---

## 2.5 근거 품질/충돌 `/evidence/quality`
### 목적
- Forced Evidence, Conflict Alert, Negative signals 운영 모니터링.

### UI(최소)
- KPI 카드:
  - conflict_count, missing_citation_count, negative_signal_hits
- 리스트:
  - candidate_id/run_id, issue_type(conflict/missing/negative), severity, created_at
- 액션:
  - [근거 상세 보기] [Needs Review 처리]

### API 포인트(예정)
- `GET /api/evidence/quality/issues?run_id=...`
- `POST /api/evidence/quality/resolve`

---

## 2.6 런 상세 `/design/runs/[runId]` (강화)
### 최소 추가 요구사항
- 상단 요약:
  - run status, scoring_version, ruleset_version, created_at, progress bar(run_progress)
- 탭:
  1) 후보 목록
  2) 파레토 프론트
  3) 실행 로그(phase)
- 후보 목록 테이블 컬럼:
  - candidate_id, target/linker/payload, EngFit/BioFit/SafetyFit, total_score, badges(rule_hit/negative/conflict), actions
- 액션:
  - [후보 상세] [비교에 추가] [리포트 생성]

---

## 2.7 후보 상세 `/design/candidates/[candidateId]` (신규)
### UI(최소)
- 요약 카드:
  - 구성(target/linker/payload), 최종 점수, 3축 점수, 버전 정보
- “설명 가능한 점수” 영역:
  - score_components(terms) 테이블(값/가중치/기여도)
  - feature_importance 간단 리스트
- Evidence 영역:
  - positive / negative / neutral 분리 리스트
  - 각 항목은 출처 링크 + 스니펫
- Protocol Pack 영역:
  - 추천 실험 템플릿 리스트 + 우선순위
- Rule Hits 영역:
  - 적중 룰 목록 + 페널티/사유
- 액션:
  - [비교에 추가] [리포트 내보내기] [피드백 남기기]

---

## 2.8 후보 비교 `/design/runs/[runId]/compare`
### UI(최소)
- 상단: 선택 후보 칩(최대 5개) + [내보내기]
- 비교 테이블(가로 비교):
  - Eng/Bio/Safety, total
  - top 5 score_components 차이
  - evidence 요약(positive/negative count)
  - protocol diff(템플릿 차이)
- 액션:
  - [리포트 생성] (선택 후보 기준)

---

## 2.9 리포트 `/design/runs/[runId]/reports`
### UI(최소)
- 생성 폼:
  - 범위: TopN(10/20/50), 또는 선택 후보
  - 포함 옵션: Evidence / Protocol / Rule Hits / Score breakdown
  - 포맷: PDF/HTML
- 히스토리:
  - created_at, scope, format, status, download(placeholder)
- API 포인트(예정)
  - `POST /api/reports/generate`
  - `GET /api/reports?run_id=...`

---

## 2.10 피드백(후보 상세 내 포함 + 목록 페이지 옵션)
### 후보 상세 내(필수)
- 라디오: agree/disagree/needs_review
- 코멘트 텍스트
- 체크박스: exclude_from_training (옵션)
- 저장 버튼

### 피드백 목록 `/design/feedback` (선택)
- run_id/candidate_id, type, author, created_at

---

## 2.11 운영/관리 `/ops/*`
### 2.11.1 시스템 상태 `/ops/status`
- 카드: Engine health / Worker health / DB / Vector index / LLM 상태(간단)
- 상태: Operational/Degraded/Paused

### 2.11.2 큐/재시도 `/ops/queues`
- 큐별: 대기/처리/실패 수
- 실패 job 리스트 + [재시도]

### 2.11.3 감사 로그 `/ops/audit`
- 필터: 기간, 이벤트 타입, 사용자, run_id
- 테이블: timestamp, actor, action, target, metadata(JSON 보기)

### 2.11.4 로그 `/ops/logs`
- 최근 에러 테이블: time, service(engine/worker/web), level, message, trace_id
- [복사] [상세] 액션

---

# 3) 라우트/파일 생성 작업(Next.js App Router 기준)

## 3.1 생성할 폴더/페이지(필수)
- `app/data/upload/page.tsx`
- `app/data/uploads/page.tsx`
- `app/evidence/search/page.tsx`
- `app/evidence/ingestion/page.tsx`
- `app/evidence/quality/page.tsx`
- `app/design/runs/[runId]/page.tsx` (탭 확장)
- `app/design/candidates/[candidateId]/page.tsx`
- `app/design/runs/[runId]/compare/page.tsx`
- `app/design/runs/[runId]/reports/page.tsx`
- `app/ops/status/page.tsx`
- `app/ops/queues/page.tsx`
- `app/ops/audit/page.tsx`
- `app/ops/logs/page.tsx`

## 3.2 사이드바 업데이트(필수)
- `components/sidebar.tsx` 또는 `components/layout/Sidebar.tsx`
- 그룹/섹션:
  - MAIN / DESIGN / CATALOG / DATA & EVIDENCE / OPS

---

# 4) 공통 UI 컴포넌트 규격(디자인 일관성)

- Table: 정렬, 페이지네이션(최소)
- Badge:
  - status: completed/processing/failed
  - evidence: conflict/negative/missing
- Empty State:
  - “데이터가 없습니다” + CTA 버튼
- Loading State:
  - skeleton rows
- Error State:
  - 에러 메시지 + [재시도]

---

# 5) 구현 우선순위(작업 순서)

## P0 (오늘 바로)
1) 사이드바 IA 반영 + 라우트 생성(전부)
2) `/data/upload`, `/evidence/search`, `/ops/status` 최소 UI
3) 런 상세 탭 확장(`/design/runs/[runId]`)
4) 후보 상세(`/design/candidates/[candidateId]`) 최소 UI

## P1 (다음)
5) 후보 비교(`/compare`) + 리포트(`/reports`)
6) 문헌 ingestion/quality
7) ops queues/audit/logs

---

# 6) 산출물 체크리스트(리뷰용)

- [ ] 사이드바에 신규 섹션 2개(Data & Evidence, Ops) 추가됨
- [ ] 신규 페이지 13개 모두 라우팅 정상
- [ ] 각 페이지에 최소 테이블/필터/상태 배지 구현
- [ ] 런 상세에서 후보 상세로 이동 가능
- [ ] 후보 상세에서 비교로 후보 추가 가능(쿼리스트링 ids)
- [ ] 리포트 페이지에서 생성 요청 버튼 노출
- [ ] Ops에서 시스템 상태 확인 가능(placeholder라도)

---

# 7) 참고(기능-체크리스트 매핑)

- 데이터 업로드/피드백: v1.3 §5.7, §9.x
- Evidence(검색/인덱싱/품질): v1.3 §5.8, §4.2, §9.5
- Ops/Audit: v1.3 §4.5, §5.11
- Compare/Reports: v1.3 Phase 1 UI 범위(런 상세/후보 상세/비교/리포트)

---
